互联网的实现，分为七层协议：物理层,数据链路层,网络层，传输层，会话层，表示层，应用层。
但是我们通常都将会话层，表示层，应用层合起来称为应用层，所以就有了我们常说的5层协议，当然也有叫4层协议的。

1 物理层
两台主机之间需要网络通信，就需要电缆、光缆、双绞线之间进行连接。然后通过这些物理设备传递0和1的电信号
2 数据链路层
但是单纯的0和1没有任何意义，我们必须规定数据解读方式:多个个电信号算一组，每个信号位有何意义，这就是链路层干的事。
我们详细说下链路层:
早期时候每家公司都有自己的电信号组合方式。主键的，被一种叫"以太网"的协议占据了主导地位，大家都使用以太网。

以太网规定，一组电信号构成一个数据包，叫做帧。每个帧分为两个部分：头和数据部分
标头包含发送方和接收方信息，数据类型等，数据则是数据包的具体内容。
上面提到以太网包含标头，标头包含发送方和接收方。那么以太网怎么表示发送方和接收方呢。以太网规定，连入网络的所有设备都必须包含"网卡"接口。数据是从一块网卡传递到另外一块网卡。那么网卡的地址就是Mac地址。

那么问题又来了，一块网卡怎么会知道另外一块网卡的地址呢？
这里用的是ARP广播协议，以太网是采用原始的方式，向当前网络的所有计算机发送广播。让每台计算机自己判断，是否要接收这个数据包，每台计算机拿到数据数据包，解析标头的mac地址，如果不是自己就抛弃。
这样链路层就可以在多台计算机之间通信了。
那么问题来了，要发送的地址如果不在同一个网络，咋办？

3  网络层
    接着上面，这时候网络层就要登场了。如果说我们要不同网络之间通信，那么就要能区分mac地址是同一个网络还是不同网络，这样，同一个网络的进行广播，不同网络的走路由，这样链路层才可以在跨网络的多台计算机之间通信。但遗憾的是，mac地址做不到这一点，因为mac地址是与厂商有关的，与所处网络无半毛钱关系。到这里网络层就正式登场了。它的作用是引进一套新的地址，能够区分是一个，还是不是同一个网络。
    于是网络层登场以后，每台计算机就有了两种地址，一个是mac地址，一个是ip地址。mac地址是绑定在网卡上的，IP地址是由分配的。
  那么怎么规范ip地址呢，就要定一个协议，就是ip协议。有了协议，那就可以分配ip地址了。Ip地址的前面部分代表网络，后一部分代表主机。但是问题又来了，网络部分可能是前面24位，也可能是16位，这个从ip地址是看不出来的。这时候就要有另外一个东西做辅助了，就是子网掩码，它是表示子网特征的一个参数。任意两个ip地址于子网掩码做AND运算，然后比较值是否相等，就可以知道是否同一个网络。
  这样通过链路层，多台计算机之间最终可以通信了。那我们再数一下数据包，前面说链路层的数据帧包含标头和数据，那这时候要加ip进来，就要包新的数据包。我们可以把ip数据包直接放进以太网的数据部分，完全不用修改以太网的规格。
  
  4 传输层
  数据是可以通信了，但是一台计算机上跑着很多程序。聊天，看网页，其他等等，都需要网络通信，那我们怎么知道过来的数据是给哪个程序呢。这时候就出来另外一个概念了，端口，每个程序都监听一个端口处理客户端请求。这样主机+端口就可以真正的实现网络通信了，unix把主机+端口叫做套接字。有了它，就可以进行网络应用程序开发了。
  
  那这样问题又来了，我们必须在数据中加入端口，那么问题照旧，需要修改原来下层的协议吗，不需要，我们只需要在ip数据包的数据中加入端口就可以了。
  
  这里分为2中情况，一种值UDP协议，就是直接在数据包中加入端口就行了。这样实现简答，但是数据发出后，如果数据包丢失，就有问题会造成数据丢失。所以就又有了另外一种TCP协议，TCP协议简单说就是一种加了确认机制的UDP协议，如果数据包发出没有收到确认，那就会重发。那不管是TCP还是udp，都是数据包包裹在ip包中的
  
  5  应用层
  最后就是应用层了，需要网络通信的程序很多，什么EMAIL,web，ftp等等，每个都有自己的协议，这些协议组合起来就是应用层。这是最高的一层，直接面向用户，数据放在tcp包的数据部分。
  因此完整的以太网数据包，就变成了，三个标头+一个数据部分。
  
  6  DNS
  上面说了要实多要主机之间的通信，就要有mac地址和ip地址。那么我们通常浏览器网页只知道一个网址，这时候就需要先发送数据到DNS解析，通过DNS解析出来IP,这样就可以给对方发送数据了。
  
  7 http
  浏览器网页用的http协议，它的数据帧就是我们上面说的结构，以太网标头(mac地址),IP标头(IP地址)，TCP标头（端口）+ http数据包
  
 http的数据会被嵌套在TCP数据包之中，TCP包加上端口再嵌套入IP包，IP包加上ip地址嵌套入以太网数据包中。经过多个网关的转发，目标服务器将收到的多个数据包，解析，根据ip标头的编号将数据部分整合得到一个完整的http请求的数据，接着做出http响应。
 
 http2协议的一大改进就是将http的头信息进行压缩，使其可以保存在一个tcp包中，而不是多个，这样就提高了速度。如果要发送一个大数据，那么tcp协议就会为每个包编号，这样服务端可以按照编号来还原数据。
 收到tcp包以后，组装还原是由操作系统完成的，操作系统组装完之后，就会交给应用程序。那要交给那个应用程序，是有tcp包里面的端口号来决定的。
 
 8 慢启动和ACK
 服务器发送数据包，当然是越快越好，但是发的越快，可能就会由于带宽不够，路由器过载，缓存溢出等问题导致数据丢失。线路不好的话，发的越快，丢的越多。
 
 最理想的状态是，在线路允许的情况下，尽可能快的发送。但是服务器怎么知道对方的线路理想速率是多少呢？答案就是慢慢试
 TCP协议为了做到效率和可靠性的统一，设计了慢启动机制，开始的时候，发送的较慢，然后根据丢包的情况，调整速率，如果不丢包，就加快；如果丢包，就降低速率。
 
 Linux内核里面定义了(常量TCP_INIT_CWND),决定刚开始是否的发送速率，刚开始是否，发送一次性发送10个数据包，即发送窗口的大小是10.然后停下来，等到接收方的确认，然后再继续发送。默认情况下，接收方收到两个tcp包，就要发送一个确认信息，英文是acknowledgement，简称就是ACK.
 
 ACK携带两个信息：
 1. 期待要收到下一个数据包的编号
 2. 接收方接收窗口的剩余容量。
 
 发送方根据这两个信息，再加上已经发送的数据包的编号，就会推测出对方的接收速度大概是多少，从而降低或者提高速度。这被称为发送窗口，发送窗口的大小是可变的。
 
 由于TCP是双向通信，所以双方都要发送ACK。两方的窗口大小很有可能不一样。而且ACK只是很简单的几个字段，通常与数据合并在一个数据包里面发送的。
 
 如果发送方连续收到三个相同的ACK包，或者超时了，还没收到ACK,就会确认丢包，从而再次发送这个包。通过这种机制确认不会有数据包丢失。
 
 
 参考地址：[http://www.52im.net/thread-1095-1-1.html]